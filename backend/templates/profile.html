<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <style>
        body { background: #0a192f; color: #fff; font-family: 'Segoe UI', sans-serif; }
        .profile-container { max-width: 600px; margin: 40px auto; background: #172a45; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.2); padding: 32px; }
        h1 { font-size: 2.5rem; margin-bottom: 24px; text-align: center; }
        .profile-field { margin-bottom: 18px; }
        label { display: block; font-weight: 600; margin-bottom: 6px; }
        input, select { width: 100%; padding: 8px 12px; border-radius: 6px; border: none; margin-bottom: 6px; font-size: 1rem; }
        .tasks-list { margin: 16px 0; }
        .task-item { background: #233554; padding: 10px 16px; border-radius: 6px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .task-actions button { background: #e63946; color: #fff; border: none; border-radius: 4px; padding: 4px 10px; cursor: pointer; }
        .add-task { display: flex; gap: 8px; margin-bottom: 16px; }
        .add-task input { flex: 1; }
        .save-btn { background: #0077b6; color: #fff; border: none; border-radius: 6px; padding: 10px 24px; font-size: 1.1rem; cursor: pointer; margin-top: 10px; display: block; width: 100%; }
        .back-btn { background: #22223b; color: #fff; border: none; border-radius: 6px; padding: 8px 18px; font-size: 1rem; cursor: pointer; margin-top: 18px; display: block; width: 100%; }
        @media (max-width: 700px) { .profile-container { padding: 12px; } }
    </style>
</head>
<body>
    <div class="profile-container">
        <h1>User Profile</h1>
        <form id="profileForm">
            <div class="profile-field">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="profile-field">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="profile-field">
                <label for="contact">Contact Number</label>
                <input type="tel" id="contact" name="contact" required>
            </div>
            <div class="profile-field">
                <label for="disability">Disability Information</label>
                <select id="disability" name="disability">
                    <option value="None">None</option>
                    <option value="Visual">Visual</option>
                    <option value="Hearing">Hearing</option>
                    <option value="Mobility">Mobility</option>
                    <option value="Cognitive">Cognitive</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="profile-field">
                <label>Tasks</label>
                <div class="add-task">
                    <input type="text" id="newTask" placeholder="Add new task...">
                    <button type="button" onclick="addTask()">Add</button>
                </div>
                <div class="tasks-list" id="tasksList"></div>
            </div>
            <button type="submit" class="save-btn">Save Profile</button>
        </form>
        <button class="back-btn" onclick="goHome()">Back to Home</button>
    </div>
    <script>
        // Profile data (simulate with localStorage for demo)
        let profile = JSON.parse(localStorage.getItem('profile')) || {
            name: 'John Doe',
            email: 'john@example.com',
            contact: '9876543210',
            disability: 'None',
            tasks: ['Check balance', 'Transfer funds']
        };

        function renderProfile() {
            document.getElementById('name').value = profile.name;
            document.getElementById('email').value = profile.email;
            document.getElementById('contact').value = profile.contact;
            document.getElementById('disability').value = profile.disability;
            renderTasks();
        }

        function renderTasks() {
            const tasksList = document.getElementById('tasksList');
            tasksList.innerHTML = '';
            profile.tasks.forEach((task, idx) => {
                const div = document.createElement('div');
                div.className = 'task-item';
                div.innerHTML = `<span>${idx + 1}. ${task}</span> <span class="task-actions"><button onclick="removeTask(${idx})">Remove</button></span>`;
                tasksList.appendChild(div);
            });
        }

        function addTask(taskText) {
            const input = document.getElementById('newTask');
            const value = taskText || input.value.trim();
            if (value) {
                profile.tasks.push(value);
                input.value = '';
                renderTasks();
                saveProfile();
            }
        }

        function removeTask(idx) {
            profile.tasks.splice(idx, 1);
            renderTasks();
            saveProfile();
        }

        function saveProfile() {
            profile.name = document.getElementById('name').value;
            profile.email = document.getElementById('email').value;
            profile.contact = document.getElementById('contact').value;
            profile.disability = document.getElementById('disability').value;
            localStorage.setItem('profile', JSON.stringify(profile));
        }

        document.getElementById('profileForm').onsubmit = function(e) {
            e.preventDefault();
            saveProfile();
            alert('Profile saved!');
        };

        function goHome() {
            window.location.href = '/home';
        }

        // --- Voice Navigation ---
        let recognition, recognizing = false;
        let awaitingTaskInput = false;
        let awaitingRemoveInput = false;
        function startVoiceNav() {
            if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) return;
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.continuous = true;
            recognition.interimResults = false;
            recognition.onresult = function(event) {
                for (let i = event.resultIndex; i < event.results.length; ++i) {
                    if (event.results[i].isFinal) {
                        const command = event.results[i][0].transcript.trim().toLowerCase();
                        if (awaitingTaskInput) {
                            addTask(command);
                            awaitingTaskInput = false;
                        } else if (awaitingRemoveInput) {
                            const idx = parseInt(command) - 1;
                            if (!isNaN(idx) && idx >= 0 && idx < profile.tasks.length) removeTask(idx);
                            awaitingRemoveInput = false;
                        } else if (command.includes('add task')) {
                            awaitingTaskInput = true;
                        } else if (command.includes('remove task')) {
                            awaitingRemoveInput = true;
                        } else if (command.includes('back to home')) {
                            goHome();
                        }
                    }
                }
            };
            recognition.onend = function() { recognizing = false; recognition.start(); };
            recognition.start();
            recognizing = true;
        }
        window.onload = function() {
            renderProfile();
            startVoiceNav();
        };
    </script>
</body>
</html> 